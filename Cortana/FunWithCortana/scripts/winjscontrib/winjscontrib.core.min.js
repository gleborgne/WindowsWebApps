/* 
 * WinJS Contrib v2.1.0.2
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

this.setImmediate||(this.setImmediate=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return setTimeout(e,0),0}),Object.map||(Object.map=function(e,n){var t={};return"object"!=typeof e?t:("function"!=typeof n&&(n=function(e,n){return[e,n]}),Object.keys(e).forEach(function(r){var i=n.apply(e,[r,e[r]]);i&&i.length&&(t[i[0]||r]=i[1])}),t)}),String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(n,t){return"undefined"!=typeof e[t]?e[t]:n})}),String.prototype.padLeft||(String.prototype.padLeft=function(e,n){return void 0===n&&(n="0"),this.length<e?(n+this).padLeft(e,n):this});var WinJSContrib;!function(e){var n;!function(e){function n(e,n){var t=WinJS.Promise.wrap(),r=[];if(!e)return WinJS.Promise.wrap([]);var i=WinJS.Promise.as(e);return i.then(function(e){for(var i=function(e,t){return e.then(function(){return WinJS.Promise.as(n(t)).then(function(e){r.push(e)})})},o=0,a=e.length;a>o;o++){var s=e[o];!s&&e.getItem&&(s=e.getItem(o)),t=i(t,s)}return t.then(function(){return r})})}function t(e,n){if(!e)return WinJS.Promise.wrap([]);var t=WinJS.Promise.as(e);return t.then(function(e){for(var t=[],r=0,i=e.length;i>r;r++){var o=e[r];!o&&e.getItem&&(o=e.getItem(r)),t.push(WinJS.Promise.as(n(o)))}return WinJS.Promise.join(t)})}function r(e,n,t){if(!e)return WinJS.Promise.wrap([]);var r=WinJS.Promise.as(e);return r.then(function(e){for(var r=WinJS.Promise.wrap(),i=[],o=[],a=!1,s=function(e,n){return e.then(function(){return WinJS.Promise.join(n.map(function(e){return WinJS.Promise.as(t(e))})).then(function(e){e=e.concat(e)},function(e){o=o.concat(e),a=!0})})},c=0,u=e.length;u>c;c++){var l=e[c];!l&&e.getItem&&(l=e.getItem(c)),i.push(l),c>0&&c%n===0&&(r=s(r,i),i=[])}return i.length&&(r=s(r,i)),r.then(function(){return a?WinJS.Promise.wrapError(o):o})})}e.waterfall=n,e.parallel=t,e.batch=r}(n=e.Promise||(e.Promise={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var n;!function(n){function t(){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(arguments[0][n]=arguments[e][n]);return arguments[0]}function r(e,n){if(!n)return!1;var t=e.match("^"+n)==n;return t}function i(e,n,t){void 0===t&&(t=1);for(var r=0;r<e.length;)setImmediate(function(){for(var i=0;t>i&&r<e.length;i++)r++,n(e[r])})}function o(e,n){return n?e.match(n+"$")==n:!1}function a(n){var t=[];for(var r in n)if(n.hasOwnProperty(r)){var i=encodeURIComponent(r),o=n[r],a=e.Utils.hasValue(o)?encodeURIComponent(o):"";t.push(i+"="+a)}return t.join("&")}function s(e,n,t,r){var i=document.createEvent("Event");i.initEvent(n,t,r),e.dispatchEvent(i)}function c(e,n,t,r,i){var o=document.createEvent("CustomEvent");o.initCustomEvent(n,t,r,i),e.dispatchEvent(o)}function u(e,n){if(e){if("this"===n)return e;var t=e[n];if("undefined"!=typeof t)return t;var r=n.indexOf("[");if(!(0>r)){var i=n.indexOf("]",r);if(!(0>i)){var o=n.substr(r+1,i-r);return o=parseInt(o),e[o]}}}}function l(n,t,r){if(n){if(e.Utils.hasValue(t))return n.setProperty?void n.setProperty(t,r):void(n[t]=r);if("string"==typeof t){var i=t.indexOf("[");if(0>i)return;var o=t.indexOf("]",i);if(0>o)return;var a=t.substr(i+1,o-i);a=parseInt(a),n[a]=r}}}function p(n,t){if("string"==typeof t&&n[t])return n[t];if(!t||!t.length)return n;var r=e.Utils.getProperty(n,t);return r?r.propValue:void 0}function f(e,n){"string"==typeof n&&(n=n.split(".")),n&&n.length||(n=["this"]);for(var t=e,r=null,i=0;i<n.length;i++){var o=new N(t,r,n[i]);if(r=o,i==n.length-1)return o;t=u(t,n[i])}}function d(n,t,r){var i=e.Utils.getProperty(n,t);i&&(i.propValue=r)}function m(e,n){return Math.random()*(n-e+1)+e<<0}function v(e,n){return e>n?1:n>e?-1:0}function h(n,t,r){if(null===n||0===n.length)return n;"undefined"==typeof r&&(r=!1);var i,o,a="",s=0,c=[];if(r)for(o=0;o<n.length;o++){if(t){var u=e.Utils.readProperty(n[o],t.split("."));i=u,u||(i=u),u&&u.toLowerCase&&(i=u.toLowerCase())}else i=n[o];a.indexOf("|"+i+"|")<0&&(a+="|"+i+"|",c[s++]=n[o])}else for(o=0;o<n.length;o++)i=t?e.Utils.readProperty(n[o],t.split(".")):n[o],a.indexOf("|"+i+"|")<0&&(a+="|"+i+"|",c[s++]=n[o]);return c}function g(t,r,i){return n.distinctArray(t,r,i).map(function(n){return e.Utils.readProperty(n,r.split("."))})}function y(e){var n=e.toLowerCase();return n=n.replace(new RegExp("[àáâãäå]","g"),"a"),n=n.replace(new RegExp("æ","g"),"ae"),n=n.replace(new RegExp("ç","g"),"c"),n=n.replace(new RegExp("[èéêë]","g"),"e"),n=n.replace(new RegExp("[ìíîï]","g"),"i"),n=n.replace(new RegExp("ñ","g"),"n"),n=n.replace(new RegExp("[òóôõö]","g"),"o"),n=n.replace(new RegExp("œ","g"),"oe"),n=n.replace(new RegExp("[ùúûü]","g"),"u"),n=n.replace(new RegExp("[ýÿ]","g"),"y")}function w(e){var n=[];WinJS.Navigation.history&&WinJS.Navigation.history.backStack&&WinJS.Navigation.history.backStack.length&&WinJS.Navigation.history.backStack.forEach(function(t){t.location!==e&&n.push(t)}),WinJS.Navigation.history.backStack=n}function S(e){return(10>e?"0":"")+e}function T(e,n,t){if(!e)return"";var r=e.length>n,i=r?e.substr(0,n-1):e;return i=t&&r?i.substr(0,i.lastIndexOf(" ")):i,r?i+"...":i}function C(){var e=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==n?t:7&t|8).toString(16)});return n}function P(e,n){if(e&&e.parentElement)for(var t=e.parentElement;t;){if(t.winControl&&void 0!==t.winControl[n])return t.winControl[n];t=t.parentElement}}function k(e,n){if(e&&n){for(var t=[],r=0;r<e.children.length;r++)t.push(e.children[r]);t.forEach(function(e){n.appendChild(e)})}}function b(e,n){if(n)for(var t=n.parentNode;t;){if(t[e]&&t.winControl)return t.winControl;t=t.parentNode}}function W(e,n){if(n)for(var t=n.parentNode;t;){if(t.classList&&t.classList.contains(e)&&t.winControl)return t.winControl;t=t.parentNode}}function J(n){return e.Utils.getParent("mcnPage",n)}function U(e){for(var n=e.parentNode;n;){if(n.msParentSelectorScope){var t=n.parentNode;if(t){var r=t.winControl;if(r)return r}}n=n.parentNode}}function E(e){if(e){var n=typeof e;if("string"==n)return new WinJS.Binding.Template(null,{href:e});if("function"==n)return{render:function(n,t){var r=e(n,t);return WinJS.Promise.as(r)}};if(e.winControl)return e.winControl;if(e.render)return e}}function I(n,t){var r=e.Utils.resolveValue(n,t);return r&&"function"==typeof r?r:void 0}function L(n,t){var r=e.Utils.resolveValue(n,t);return r?"function"==typeof r?r(n):r:void 0}function A(e,t,r){var i=t.split(":");if(i.length>1){var o=i[0],a=t.substr(o.length+1),s=n.ValueParsers[o];if(s)return s(e,a,r)}return t}function x(n,t,r,i,o){var a=e.Utils.resolveValue(n,t,o);a&&a.then&&a.mcnMustResolve?a.then(function(n){e.Utils.writeProperty(r,i,n)}):e.Utils.writeProperty(r,i,a)}function _(e){return"undefined"!=typeof e&&null!==e}function M(e){return"{0} - {1}: {2}".format(e.status,e.statusText,e.responseText)}function q(e){return function(n){for(var t=null,r=0;r<n.length;r++){var i=n[r];if("undefined"!=typeof i){t=i;break}}return e(t)}}function D(e,n){if(n)for(var t in n)e[t]=n[t]}n.extend=t,n.startsWith=r,String.prototype.startsWith||(String.prototype.startsWith=function(n){return e.Utils.startsWith(this,n)}),n.asyncForEach=i,n.endsWith=o,String.prototype.endsWith||(String.prototype.endsWith=function(n){return e.Utils.endsWith(this,n)}),n.queryStringFrom=a,n.triggerEvent=s,n.triggerCustomEvent=c,n.readProperty=p;var N=function(){function e(e,n,t){this.parent=e,this.parentDescriptor=n,this.keyProp=t}return e.prototype.ensureParent=function(){return parent?parent:void(this.parentDescriptor&&(this.parentDescriptor.ensureParent(),this.parentDescriptor.parent[this.parentDescriptor.keyProp]||(this.parentDescriptor.parent[this.parentDescriptor.keyProp]={},this.parent=this.parentDescriptor.parent[this.parentDescriptor.keyProp])))},Object.defineProperty(e.prototype,"propValue",{get:function(){return u(this.parent,this.keyProp)},set:function(e){this.ensureParent(),l(this.parent,this.keyProp,e)},enumerable:!0,configurable:!0}),e}();n.PropertyDescriptor=N,n.getProperty=f,n.writeProperty=d,n.randomFromInterval=m,n.alphabeticSort=v,n.distinctArray=h,n.getDistinctPropertyValues=g,n.removeAccents=y,n.removePageFromHistory=w,n.pad2=S,n.ellipsisizeString=T,n.guid=C,n.inherit=P,n.moveChilds=k,n.getParent=b,n.getParentControlByClass=W,n.getParentPage=J,n.getScopeControl=U,n.getTemplate=E,n.resolveMethod=I,n.readValue=L,n.ValueParsers={navpage:function(n,t,r){var i=r&&r.data?r.data.navpage:null;if(i||(e.Utils.getParentPage&&(i=e.Utils.getParentPage(n),r&&r.data&&(r.data.navpage=i)),!i&&e.UI.Application.navigator&&(i=e.UI.Application.navigator.pageControl,r&&r.data&&(r.data.navpage=i))),i){r&&(r.parentControl=i);var o=e.Utils.readProperty(i,t);return o&&"function"==typeof o?o.bind(i):o}},page:function(n,t,r){var i=r&&r.data?r.data.page:null;if(i||(i=e.Utils.getParentControlByClass("pagecontrol",n),r&&r.data&&(r.data.page=i)),i){r&&(r.parentControl=i);var o=e.Utils.readProperty(i,t);return o&&"function"==typeof o?o.bind(i):o}},ctrl:function(n,t,r){var i=r&&r.data?r.data.scope:null;if(i||(i=e.Utils.getScopeControl(n),r&&r.data&&(r.data.scope=i)),i){r&&(r.parentControl=i);var o=e.Utils.readProperty(i,t);return o&&"function"==typeof o?o.bind(i):o}},select:function(n,t,r){var i=r&&r.data?r.data.scope:null;i||(i=e.Utils.getScopeControl(n),r&&r.data&&(r.data.scope=i));var n=null,o=t.split("|"),a=o[0];if(i&&(n=i.element.querySelector(a)),n||(n=document.querySelector(a)),1==o.length)return n;if(o.length>1){var s=p(n,t.substr(o[0].length+1));return s}},obj:function(n,t){return WinJS.UI.optionsParser(t,window,{select:WinJS.Utilities.markSupportedForProcessing(function(t){var r=e.Utils.getScopeControl(n);return r?r.element.querySelector(t):document.querySelector(t)})})},prom:function(e,n,t){var r=A(e,n,t);return r.then&&(r=r.then(null,null),r.mcnMustResolve=!0),r},list:function(e,n,t){var r=A(e,n,t);if(r){if(r.then){var i=r.then(function(e){return new WinJS.Binding.List(e).dataSource});return i.mcnMustResolve=!0,i}return new WinJS.Binding.List(r).dataSource}},global:function(n,t){return e.Utils.readProperty(window,t)},templ:function(n,t){return e.Templates.get(t)},element:function(e,n,t){var r=A(e,n,t);return r?r.element:void 0},event:function(e,n,t){var r=A(e,n,t),i=null;r&&t&&t.name&&(t&&(i=t.parentControl),r&&"function"==typeof r&&(i&&i.eventTracker?i.eventTracker.addEvent(t.control,t.name,r):t.control.addEventListener(t.name,r)))}},n.resolveValue=A,n.applyValue=x,n.hasValue=_,n.formatXHRError=M,n.unwrapJoinError=q,n.inject=D}(n=e.Utils||(e.Utils={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var n;!function(n){function t(e){var n=o[e];return o[e]?n:new WinJS.Binding.Template(null,{href:e})}function r(n,t){var r=e.Templates.get(n);if(r)return e.Templates.makeInteractive(r,t);throw{message:"template not found for "+n}}function i(n,t){return function(r){return r.then(function(r){return n.render(r).then(function(n){if(t.tap)for(var i in t.tap){var o=n.querySelector(i);e.UI.tap(o,function(e){t.tap[i](e,r)})}if(t.click)for(var i in t.click){var o=n.querySelector(i);o.onclick=function(e){t.click[i](e,r)}}return n})})}}var o={};n.get=t,n.interactive=r,n.makeInteractive=i}(n=e.Templates||(e.Templates={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var n;!function(n){function t(e,n){for(var t=0,r=0,i=e.clientWidth,o=e.clientHeight;e&&e!=n;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,r+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:r,width:i,height:o}}function r(){var e=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(e&&e.length)for(var n=0;n<e.length;n++){var t=e[n];t.winControl&&t.winControl.show()}}function i(){var e=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(e&&e.length)for(var n=0;n<e.length;n++){var t=e[n];t.winControl&&t.winControl.hide()}}function o(){var e=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(e&&e.length)for(var n=0;n<e.length;n++){var t=e[n];t.winControl&&(t.winControl.disabled=!0)}}function a(){var e=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(e&&e.length)for(var n=0,t=e.length;t>n;n++){var r=e[n];r.winControl&&(r.winControl.disabled=!1)}}function s(e,n){return new WinJS.Promise(function(t,r){function i(){e.onload=void 0,e.onerror=void 0,e.onreadystatechange=void 0,r("element not loaded")}function o(){e.onload=void 0,e.onerror=void 0,e.onreadystatechange=void 0,t({element:e,url:n})}e.onerror=i,e.onload=o,e.onreadystatechange=o,e.naturalWidth>0&&o(void 0),e.src=n})}function c(e){return new WinJS.Promise(function(n,t){function r(){o.onload=void 0,o.onerror=void 0,t({message:"image not loaded : "+e,path:e})}function i(){o.onload=void 0,o.onerror=void 0,n({element:o,url:e})}var o=new Image;o.onerror=r,o.onload=i,o.naturalWidth>0&&i(void 0),o.src=e})}function u(e){var n=[],t=!1;if(e.parentElement)for(var r=e.parentElement,i=0;i<r.children.length;i++)r.children[i]===e?t=!0:t&&n.push(r.children[i]);return n}function l(n){return new WinJS.Promise(function(t){var r=e.UI.listElementsAfterMe(n),i=WinJS.UI.Animation.createDeleteFromListAnimation([n],r);n.style.position="fixed",n.style.opacity="0",i.execute().done(function(){t(n)})})}function p(n,t,r){n.classList.add("page-action");var i=n.dataset.pageAction||n.getAttribute("tap"),o=r[i];o&&"function"==typeof o&&e.UI.tap(n,function(t){var o=WinJS.Promise.wrap(),a=t.dataset.pageActionArgs||n.getAttribute("tap-args");if(a&&"string"==typeof a){var s=e.Utils.readValue(t,a);o=WinJS.Promise.as(s).then(function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(n){return}return e}),s&&(a=s)}o.then(function(){r[i].bind(r)({elt:t,args:a})})})}function f(e,n){var t=e.querySelectorAll("*[data-page-action], *[tap]");if(t&&t.length)for(var r=0,i=t.length;i>r;r++){var o=t[r];p(o,e,n)}}function d(n){n.classList.add("page-link");var t=n.getAttribute("applink"),r=n.dataset.pageLink||n.getAttribute("linkto");if(r&&r.indexOf("/")<0){var i=e.Utils.readProperty(window,r);i&&(r=i)}r&&e.UI.tap(n,function(i){var o=WinJS.Promise.wrap(),a=i.dataset.pageActionArgs||n.getAttribute("linkto-args");if(a&&"string"==typeof a){var s=e.Utils.readValue(i,a);o=WinJS.Promise.as(s).then(function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(n){}return e})}o.then(function(n){if(!t&&e.UI.parentNavigator&&e.UI.parentNavigator(i)){var o=e.UI.parentNavigator(i);o.navigate(r,n)}else WinJS.Navigation.navigate(r,n)})})}function m(e){var n=e.querySelectorAll("*[data-page-link], *[linkto]");if(n&&n.length)for(var t=0,r=n.length;r>t;t++){var i=n[t];d(i,e)}}function v(e){for(var n=e.parentNode;n;){if(n.mcnNavigator)return n.winControl;n=n.parentNode}}function h(e,n,t){e.classList.add("page-member");var r=e.dataset.pageMember||e.getAttribute("member");r||(r=e.id),r&&!t[r]&&(t[r]=e,e.winControl&&(t[r]=e.winControl))}function g(e,n){var t=e.querySelectorAll("*[data-page-member], *[member]");if(t&&t.length)for(var r=0,i=t.length;i>r;r++){var o=t[r];h(o,e,n)}}function y(n,t){e.UI.bindPageActions(n,t),e.UI.bindPageLinks(n)}function w(n,t){function r(e){var n=new WinJS.Promise(function(){});e.detail.setPromise(n),n.cancel()}var i={control:n,callback:t};W.push(i);var o=function(e){var n=W.indexOf(i);if(n===W.length-1)for(i.callback.bind(i.control)(e),n--;n>=0&&!e.handled;){var t=W[n];t.callback.bind(t.control)(e),n--}};WinJS.Navigation.addEventListener("beforenavigate",r),window.Windows&&window.Windows.Phone?window.Windows.Phone.UI.Input.HardwareButtons.addEventListener("backpressed",o):document.addEventListener("backbutton",o);var a=function(e){("Esc"===e.key||"Backspace"===e.key)&&o(e)};return document.body.addEventListener("keypress",a),e.UI.Application&&e.UI.Application.navigator&&e.UI.Application.navigator.addLock(),function(){e.UI.Application&&e.UI.Application.navigator&&e.UI.Application.navigator.removeLock();var n=W.indexOf(i);W.splice(n,1),document.body.removeEventListener("keypress",a),WinJS.Navigation.removeEventListener("beforenavigate",r),window.Windows&&window.Windows.Phone?window.Windows.Phone.UI.Input.HardwareButtons.removeEventListener("backpressed",o):document.removeEventListener("backbutton",o)}}function S(e){e&&e.mcnTapTracking&&(e.mcnTapTracking.dispose(),e.mcnTapTracking=null)}function T(e){if(e)for(var n=e.querySelectorAll(".tap"),t=0,r=n.length;r>t;t++)S(n[t])}function C(n,t,r){if(n){var i=function(e){var n=e.currentTarget||e.target,t=n.mcnTapTracking;t&&(void 0===e.button||0===e.button||t.allowRickClickTap&&2===e.button)&&(t.lock&&(e.pointerId&&e.currentTarget.setPointerCapture&&e.currentTarget.setPointerCapture(e.pointerId),e.stopPropagation(),e.preventDefault()),WinJS.Utilities.addClass(n,"tapped"),t.pointerdown=e.changedTouches?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:{x:e.clientX,y:e.clientY},t.animDown(e.currentTarget),t.tapOnDown&&t.callback(n))},o=function(e){var n=e.currentTarget||e.target,t=n.mcnTapTracking;t&&t.pointerdown&&(WinJS.Utilities.removeClass(n,"tapped"),e.pointerId&&n.releasePointerCapture&&n.releasePointerCapture(e.pointerId),t.disableAnimation||t.animUp(e.currentTarget))},a=function(e){var n=e.currentTarget||e.target,t=n.mcnTapTracking;if(t&&(void 0===e.button||0===e.button||t.allowRickClickTap&&2===e.button)){if(n.releasePointerCapture&&n.releasePointerCapture(e.pointerId),t&&!t.tapOnDown){e.stopPropagation();var r=function(){if(t&&t.pointerdown){if(e.changedTouches)var r=Math.abs(t.pointerdown.x-e.changedTouches[0].clientX),i=Math.abs(t.pointerdown.y-e.changedTouches[0].clientY);else var r=Math.abs(t.pointerdown.x-e.clientX),i=Math.abs(t.pointerdown.y-e.clientY);t.callback&&15>r&&15>i&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t.callback(n)),t&&t.pointerdown&&(t.pointerdown=void 0)}};t.awaitAnim?t.animUp(n).done(r):(t.animUp(n),r())}WinJS.Utilities.removeClass(n,"tapped")}},s=r||{};n.mcnTapTracking&&n.mcnTapTracking.dispose(),WinJS.Utilities.addClass(n,"tap"),n.mcnTapTracking=n.mcnTapTracking||{},n.mcnTapTracking.eventTracker=new e.UI.EventTracker,n.mcnTapTracking.disableAnimation=s.disableAnimation,n.mcnTapTracking.disableAnimation?(n.mcnTapTracking.animDown=function(){return WinJS.Promise.wrap()},n.mcnTapTracking.animUp=function(){return WinJS.Promise.wrap()}):(n.mcnTapTracking.animDown=s.animDown||WinJS.UI.Animation.pointerDown,n.mcnTapTracking.animUp=s.animUp||WinJS.UI.Animation.pointerUp),n.mcnTapTracking.element=n,n.mcnTapTracking.callback=t,n.mcnTapTracking.lock=s.lock,n.mcnTapTracking.awaitAnim=s.awaitAnim||!1,n.mcnTapTracking.disableAnimation=s.disableAnimation,n.mcnTapTracking.tapOnDown=s.tapOnDown,n.mcnTapTracking.pointerModel="none",n.mcnTapTracking.dispose=function(){WinJS.Utilities.removeClass(n,"tap"),this.eventTracker.dispose(),n.mcnTapTracking=null,n=null},void 0!==n.onpointerdown?(n.mcnTapTracking.pointerModel="pointers",n.mcnTapTracking.eventTracker.addEvent(n,"pointerdown",i),n.mcnTapTracking.eventTracker.addEvent(n,"pointerout",o),n.mcnTapTracking.eventTracker.addEvent(n,"pointerup",a)):window.Touch&&!s.noWebkitTouch?(n.mcnTapTracking.pointerModel="touch",n.mcnTapTracking.eventTracker.addEvent(n,"touchstart",function(e){n.mcnTapTracking.cancelMouse=!0,i(e)}),n.mcnTapTracking.eventTracker.addEvent(n,"touchcancel",function(e){setTimeout(function(){n.mcnTapTracking.cancelMouse=!1},1e3),o(e)}),n.mcnTapTracking.eventTracker.addEvent(n,"touchend",function(e){setTimeout(function(){n.mcnTapTracking.cancelMouse=!1},1e3),a(e)}),n.mcnTapTracking.eventTracker.addEvent(n,"mousedown",function(e){n.mcnTapTracking.cancelMouse||i(e)}),n.mcnTapTracking.eventTracker.addEvent(n,"mouseleave",function(e){o(e)}),n.mcnTapTracking.eventTracker.addEvent(n,"mouseup",function(e){n.mcnTapTracking.cancelMouse?o(e):a(e)})):(n.mcnTapTracking.pointerModel="mouse",n.mcnTapTracking.eventTracker.addEvent(n,"mousedown",i),n.mcnTapTracking.eventTracker.addEvent(n,"mouseleave",o),n.mcnTapTracking.eventTracker.addEvent(n,"mouseup",a))}}function P(e,n){var t=null;return new WinJS.Promise(function(r){var i=function(n){n.srcElement===e&&o()},o=function(){clearTimeout(t),e.removeEventListener("transitionend",i,!1),r()};e.addEventListener("transitionend",i,!1),t=setTimeout(o,n||1e3)})}n.Application={},n.disableAutoResources=!1,n.offsetFrom=t;var k=function(){function e(){this.events=[]}return e.prototype.addEvent=function(e,n,t,r){var i=this;e.addEventListener(n,t,r);var o=function(){try{e.removeEventListener(n,t);var r=i.events.indexOf(o);r>=0&&i.events.splice(r,1)}catch(a){console.error("unexpected error while releasing callback "+a.message)}};return this.events.push(o),o},e.prototype.addBinding=function(e,n,t){e.bind(n,t);var r=function(){e.unbind(n,t)};return this.events.push(r),r},e.prototype.dispose=function(){for(var e=0;e<this.events.length;e++)this.events[e]();this.events=[]},e}();n.EventTracker=k,n.appbarsOpen=r,n.appbarsClose=i,n.appbarsDisable=o,n.appbarsEnable=a,n.elementLoaded=s,n.loadImage=c,n.listElementsAfterMe=u,n.removeElementAnimation=l,n.bindPageActions=f,n.bindPageLinks=m,n.parentNavigator=v,n.bindMembers=g,n.bindActions=y;var b=function(){function e(e,n){var t=this;t.queries=[],t.linkedControl=n;for(var r in e){var i=e[r];i.query&&t.registerMediaEvent(r,i.query,i)}}return e.prototype.dispose=function(){var e=this;e.linkedControl=null,this.queries.forEach(function(e){e.dispose()})},e.prototype.registerMediaEvent=function(e,n,t){var r=this,i=window.matchMedia(n),o={name:e,query:n,data:t,mq:i,dispose:null},a=function(e){e.matches&&r._mediaEvent(e,o)};i.addListener(a),o.dispose=function(){i.removeListener(a)},r.queries.push(o)},e.prototype._mediaEvent=function(e,n){var t=this;t.linkedControl&&WinJS.UI.setOptions(t.linkedControl,n.data),t.dispatchEvent("media",n)},e.prototype.check=function(){var e=this;e.queries.forEach(function(n){var t=window.matchMedia(n.query);t.matches&&e._mediaEvent({matches:!0},n)})},e.prototype.addEventListener=function(){},e.prototype.dispatchEvent=function(){return!1},e.prototype.removeEventListener=function(){},e}();n.MediaTrigger=b,WinJS.Class.mix(e.UI.MediaTrigger,WinJS.Utilities.eventMixin);var W=[];n.registerNavigationEvents=w,n.untap=S,n.untapAll=T,n.tap=C,n.afterTransition=P;var J=function(){function n(e,n,t,r){this.element=document.createElement(e),n&&(this.element.className=n),t&&t.appendChild(this.element),this.parent=r,this.childs=[],r&&r.childs.push(this)}return n["for"]=function(e){var t=new n(null);return t.element=e,t},n.fragment=function(){var e=new n(null);return e.element=document.createDocumentFragment(),e},Object.defineProperty(n.prototype,"control",{get:function(){return this.element.winControl},enumerable:!0,configurable:!0}),n.prototype.addClass=function(e){return this.element.classList.add(e),this},n.prototype.className=function(e){return this.element.className=e,this},n.prototype.opacity=function(e){return this.element.style.opacity=e,this},n.prototype.display=function(e){return this.element.style.display=e,this},n.prototype.hide=function(){return this.element.style.display="none",this},n.prototype.visibility=function(e){return this.element.style.visibility=e,this},n.prototype.text=function(e){return this.element.textContent=e,this},n.prototype.html=function(e){return this.element.innerHTML=e,this},n.prototype.attr=function(e,n){return this.element.setAttribute(e,n),this},n.prototype.style=function(e,n){return this.element.style[e]=n,this},n.prototype.styles=function(e){var n=this.element.style,t=Object.keys(e);return t.forEach(function(t){n[t]=e[t]}),this},n.prototype.appendTo=function(e){return e.appendChild(this.element),this},n.prototype.tap=function(n,t){return e.UI.tap(this.element,n,t),this},n.prototype.append=function(e,t,r){var i=new n(e,t,this.element,this);return r&&r(i),this},n.prototype.createChild=function(e,t){var r=new n(e,t,this.element,this);return r},n.prototype.ctrl=function(n,t){var r=n;return"string"==typeof n&&(r=e.Utils.readProperty(window,n)),r&&new r(this.element,t),this},n}();n.FluentDOM=J}(n=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));var __global=this,profiler=__global.msWriteProfilerMark||function(){},WinJSContrib;!function(e){var n;!function(n){var t;!function(n){function t(e,n,t,r,i,o){var a=[];i&&a.push(WinJS.Promise.as(i.apply(e,r)));var s=n.querySelectorAll(".mcn-layout-ctrl");if(s&&s.length){for(var c=0,u=s.length;u>c;){var l=s[c];if(l){var p=l.winControl[t];p&&a.push(l.winControl.pageLifeCycle?l.winControl.pageLifeCycle.steps.layout.promise:WinJS.Promise.as(p.apply(l.winControl,r)))}l&&l.winControl&&l.winControl.pageLifeCycle?(c+=l.querySelectorAll(".mcn-fragment, .mcn-layout-ctrl").length+1,l.winControl.__checkLayout()):c+=1}return WinJS.Promise.join(a).then(function(){return o?WinJS.Promise.as(o.apply(e,r)):void 0})}return o?WinJS.Promise.as(o.apply(e,r)):WinJS.Promise.wrap()}function r(n,t,r,i){function o(n){r&&r.injectToPage&&e.Utils.inject(n,r.injectToPage),n.navigationState={location:t,state:r},i.oncreate&&i.oncreate(n.element,r),i.oninit&&n.pageLifeCycle.steps.init.attach(function(){return i.oninit(n.element,r)}),(n.enterPageAnimation||i.enterPage)&&(n._enterAnimation=n.enterPageAnimation?n.enterPageAnimation:i.enterPage,n.enterPageAnimation=function(){var e=this,n=null;return c.style.opacity="",n=e&&e.getAnimationElements?e.getAnimationElements(!1):e.element,n?e._enterAnimation(n):void 0}),i.onrender&&n.pageLifeCycle.steps.process.attach(function(){i.onrender(n.element,r)}),e.UI.disableAutoResources||n.pageLifeCycle.steps.process.attach(function(){return WinJS.Resources.processAll(c)}),i.closeOldPagePromise&&n.pageLifeCycle.steps.ready.attach(function(){return i.closeOldPagePromise}),n.pageLifeCycle.steps.ready.attach(function(){return i.onready&&i.onready(n.element,r),n.enterPageAnimation?WinJS.Promise.as(n.enterPageAnimation(c,i)):void(n.element.style.opacity="")}),n.pageLifeCycle.steps.ready.promise.then(a,s)}var a,s;i=i||{};var c=document.createElement("div");c.setAttribute("dir",__global.getComputedStyle(c,null).direction),c.style.opacity="0",n.appendChild(c);{var u=new WinJS.Promise(function(e,n){a=e,s=n}),l=i.parented?WinJS.Promise.as(i.parented):null,p=WinJS.UI.Pages.get(t);new p(c,r,o,l)}return u}n.defaultFragmentMixins=[{$:function(e){return $(e,this.element||this._element)},q:function(e){return this.element?this.element.querySelector(e):void 0},qAll:function(e){if(this.element){var n=this.element.querySelectorAll(e);return n&&!n.forEach&&(n=[].slice.call(n)),n}}},{dispose:function(){this._promises&&(this.cancelPromises(),this._promises=null)},promises:{configurable:!0,get:function(){return this._promises||(this._promises=[]),this._promises}},addPromise:function(e){return this.promises.push(e),e},cancelPromises:function(){var e=this;if(e.promises){for(var n=0;n<e.promises.length;n++)e.promises[n]&&e.promises[n].cancel();e.promises=[]}}},{dispose:function(){this._eventTracker&&(this._eventTracker.dispose(),this._eventTracker=null)},eventTracker:{configurable:!0,get:function(){return this._eventTracker||(this._eventTracker=new e.UI.EventTracker),this._eventTracker}}}],n.renderFragment=r;var i=function(){function e(e,n,t){var r=this;this.queue=[],this.isDone=!1,this.stepName=n,this.promise=new WinJS.Promise(function(e,n){r._resolvePromise=e,r._rejectPromise=n}),e.promises.push(this.promise),t&&t.pageLifeCycle&&t.pageLifeCycle.steps[n].attach(function(){return r.promise})}return e.prototype.attach=function(e){return this.queue&&!this.isDone?(this.queue.push(e),this.promise):WinJS.Promise.as(e())},e.prototype.resolve=function(e){function n(){return t._resolvePromise(e),t.promise}var t=this;if(this.isDone=!0,this.queue&&this.queue.length){var r=[];return this.queue.forEach(function(e){r.push(new WinJS.Promise(function(n,t){try{WinJS.Promise.as(e()).then(function(e){n(e)},t)}catch(r){t(r)}}))}),this.queue=null,WinJS.Promise.join(r).then(function(){return n()},this.reject.bind(this))}return this.queue=null,n()},e.prototype.reject=function(e){return this.isDone=!0,this.queue=null,this._rejectPromise(e),WinJS.Promise.wrapError(this.promise)},e}();n.PageLifeCycleStep=i,function(n,r,o,a,s,c,u,l,p,f){"use strict";function d(e){var n=r.document.createElement("a");return n.href=e,n.href}function m(e){return r.document.location.href.toLowerCase()===e.toLowerCase()}function v(e,n){var t=e.prototype.dispose;return e=o.Class.mix(e,n),t&&n.hasOwnProperty("dispose")&&(e.prototype.dispose=function(){n.dispose.apply(this),t.apply(this)}),e}function h(e,n){var t=Object.keys(e.prototype);return t.forEach(function(t){void 0===n.prototype[t]&&(n.prototype[t]=e.prototype[t])}),e}function g(e,n){return n?"function"==typeof n?(e.prototype._attachedConstructor=n,h(e,n)):"object"==typeof n?v(e,n):e:e}function y(n,r,i,o,a,c){i.style.display&&(n.pageLifeCycle.initialDisplay=i.style.display),i.style.display="none";var p=" uri='"+r+"'"+s._getProfilerMarkIdentifier(n.element);u("WinJS.UI.Pages:createPage"+p+",StartTM"),e.UI.WebComponents&&(n.pageLifeCycle.observer=e.UI.WebComponents.watch(n.element));var f=l.timeout().then(function(){return n.load(r)}).then(function(e){if(n._attachedConstructor){var t=new n._attachedConstructor(i,o);i.winControl=t;var r=Object.keys(n);r.forEach(function(e){t[e]=n[e]}),t.pageLifeCycle.page=t,n.pageControl=t,n.dismissed=!0,n=t}return e}),d=f.then(function(e){return l.join({loadResult:e,initResult:n.init(i,o)})}).then(function(e){return n.pageLifeCycle.steps.init.resolve().then(function(){return e})}).then(function(e){return n.render(i,o,e.loadResult)}).then(function(){return n.rendered(i,o)}).then(function(){return n.pageLifeCycle.steps.render.resolve()}).then(function(){return e.UI.WebComponents?WinJS.Promise.timeout():void 0});n.elementReady=d.then(function(){return i}),n.renderComplete=d.then(function(){return n.process(i,o)}).then(function(){return n.pageLifeCycle.steps.process.resolve()}).then(function(){return e.UI.bindMembers(i,n),n.processed(i,o)}).then(function(){return n});var m=function(){a&&a(n),u("WinJS.UI.Pages:createPage"+p+",StopTM")};n.renderComplete.then(m,m),n.layoutComplete=n.renderComplete.then(function(){return c}).then(function(){i.style.display=n.pageLifeCycle.initialDisplay||"";i.getBoundingClientRect();return t(n,i,"pageLayout",[i,o],null,n.pageLayout)}).then(function(){e.UI.bindActions(i,n)}).then(function(){return n.pageLifeCycle.steps.layout.resolve()}).then(function(){return n}),n.readyComplete=n.layoutComplete.then(function(){n.ready(i,o),n.pageLifeCycle.ended=new Date,n.pageLifeCycle.delta=n.pageLifeCycle.ended-n.pageLifeCycle.created,console.log("navigation to "+r+" took "+n.pageLifeCycle.delta+"ms")}).then(function(){return n.pageLifeCycle.steps.ready.resolve()}).then(function(){return n}).then(null,function(e){if(n.error)return n.error(e);if(!e||!e._value||"Canceled"!==e._value.name)return WinJS.Promise.wrapError(e)}),n.__checkLayout=function(){var e=this,n=arguments,r=null;return r=e.updateLayout?WinJS.Promise.as(e.updateLayout.apply(e,n)):WinJS.Promise.wrap(),r.then(function(){return t(e,e.element,"updateLayout",n)})}}function w(n,t){var a=d(n).toLowerCase(),s=k[a];return n=d(n),s||(s=o.Class.define(function(t,o,a,s){var u=this,l=e.Utils.getScopeControl(t);c.addClass(t,"win-disposable"),c.addClass(t,"pagecontrol"),c.addClass(t,"mcn-layout-ctrl"),u.pageLifeCycle={created:new Date,location:n,stop:function(){u.readyComplete.cancel(),u.cancelPromises(),this.observer&&(this.observer.disconnect(),this.observer=null)},steps:{init:new i(u,"init",null),render:new i(u,"render",null),process:new i(u,"process",l),layout:new i(u,"layout",l),ready:new i(u,"ready",l)},initialDisplay:null},this._disposed=!1,this.element=t=t||r.document.createElement("div"),t.msSourceLocation=n,this.uri=n,this.selfhost=m(n),t.winControl=this,u.parentedComplete=s,y(this,n,t,o,a,s)},b),s=o.Class.mix(s,WinJS.UI.DOMEventMixin),e.UI.Pages.defaultFragmentMixins.forEach(function(e){v(s,e)
}),k[a]=s),s=g(s,t),s.selfhost=m(n),s}function S(e,t){var i=k[e];return i||(i=w(e)),t&&(i=g(i,t)),i.selfhost&&WinJS.Utilities.ready(function(){T(d(e),r.document.body)},!0),a.viewMap||a._viewMap||"function"==typeof t||n._corePages.define(e,t),i}function T(e,n,t,r){var i=a.get(e),o=new i(n,t,null,r);return o.renderComplete.then(null,function(e){return l.wrapError({error:e,page:o})})}function C(e){var n=k[e];return n||(n=S(e)),n}function P(e){p.clearCache(d(e)),delete k[e.toLowerCase()]}if(r.document&&a){var k=a._viewMap||a.viewMap||{},b={dispose:function(){this._disposed||(this.pageLifeCycle.stop(),this.pageLifeCycle=null,this._disposed=!0,this.readyComplete.cancel(),c.disposeSubTree(this.element),this.element=null)},init:function(){},load:function(e){return this.selfhost?void 0:p.renderCopy(d(e))},process:function(e){return f.processAll(e)},processed:function(){},render:function(e,n,t){return this.selfhost||e.appendChild(t),e},rendered:function(){},ready:function(){}};n._corePages={get:a.get,render:a.render,define:a.define,_remove:a._remove,_viewMap:k};var W={define:S,get:C,render:T,_remove:P,_viewMap:k},J=WinJS.UI.Pages;WinJS.Namespace._moduleDefine(n,null,W),J.get=W.get,J.define=W.define,J.render=W.render,J._remove=W._remove,WinJS.UI.HtmlControl=WinJS.Class.define(function(e,n,t){WinJS.UI.Pages.render(n.uri,e,n).then(t,function(){t()})})}}(e.UI.Pages,__global,WinJS,WinJS.UI.Pages,WinJS.Utilities,WinJS.Utilities,profiler,WinJS.Promise,WinJS.UI.Fragments,WinJS.UI)}(t=n.Pages||(n.Pages={}))}(n=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));